// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

enum employeeRole {
    NONE
    SURGEON
    NURSE
}

model Employee {
    id                 Int          @id @default(autoincrement())
    ssn                String       @unique
    name               String
    address            String?
    phone              String?
    gender             String
    salary             Float?
    role               employeeRole @default(NONE)
    availability       Boolean?     @default(true)
    primaryPhysicianId Int?
    primaryPhysician   Physician?   @relation(fields: [primaryPhysicianId], references: [id])
    surgeries          Surgery[]
}

model Physician {
    id        Int        @id @default(autoincrement())
    specialty String
    grade     String?
    employees Employee[]
}

model Nurse {
    id        Int       @id @default(autoincrement())
    years     Int
    grade     String?
    surgeries Surgery[]
}

model Surgery {
    id           Int      @id @default(autoincrement())
    name         String
    type         String
    location     String
    specialNeeds String?
    surgeonId    Int
    nurseId      Int?
    patientId    Int
    date         DateTime
    duration     Int
    surgeon      Employee @relation(fields: [surgeonId], references: [id])
    nurse        Nurse?   @relation(fields: [nurseId], references: [id])
    patient      Patient  @relation(fields: [patientId], references: [id])
}

model Patient {
    id          Int           @id @default(autoincrement())
    name        String
    gender      String
    dob         DateTime
    address     String?
    ssn         String        @unique
    bloodType   String?
    medicalData MedicalData[]
    surgeries   Surgery[]
    allergies   Allergy[]
}

model MedicalData {
    id        Int      @id @default(autoincrement())
    patientId Int
    type      String
    date      DateTime
    notes     String?
    patient   Patient  @relation(fields: [patientId], references: [id])
}

model Allergy {
    id        Int     @id @default(autoincrement())
    patientId Int
    name      String
    severity  String
    reactions String?
    frequency Int?
    patient   Patient @relation(fields: [patientId], references: [id])
}
